<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<!-- NewPage -->
<html lang="en">
<head>
<!-- Generated by javadoc (1.8.0_45) on Mon Jun 20 13:17:20 EDT 2016 -->
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<title>CSRFTokenManager (stateless-csrf 1.0 API)</title>
<meta name="date" content="2016-06-20">
<link rel="stylesheet" type="text/css" href="../../../../stylesheet.css" title="Style">
<script type="text/javascript" src="../../../../script.js"></script>
</head>
<body>
<script type="text/javascript"><!--
    try {
        if (location.href.indexOf('is-external=true') == -1) {
            parent.document.title="CSRFTokenManager (stateless-csrf 1.0 API)";
        }
    }
    catch(err) {
    }
//-->
var methods = {"i0":10,"i1":10,"i2":10,"i3":10,"i4":10,"i5":10,"i6":10,"i7":10};
var tabs = {65535:["t0","All Methods"],2:["t2","Instance Methods"],8:["t4","Concrete Methods"]};
var altColor = "altColor";
var rowColor = "rowColor";
var tableTab = "tableTab";
var activeTableTab = "activeTableTab";
</script>
<noscript>
<div>JavaScript is disabled on your browser.</div>
</noscript>
<!-- ========= START OF TOP NAVBAR ======= -->
<div class="topNav"><a name="navbar.top">
<!--   -->
</a>
<div class="skipNav"><a href="#skip.navbar.top" title="Skip navigation links">Skip navigation links</a></div>
<a name="navbar.top.firstrow">
<!--   -->
</a>
<ul class="navList" title="Navigation">
<li><a href="../../../../com/demandware/appsec/csrf/package-summary.html">Package</a></li>
<li class="navBarCell1Rev">Class</li>
<li><a href="class-use/CSRFTokenManager.html">Use</a></li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../../../index-all.html">Index</a></li>
<li><a href="../../../../help-doc.html">Help</a></li>
</ul>
</div>
<div class="subNav">
<ul class="navList">
<li><a href="../../../../com/demandware/appsec/csrf/CSRFErrorHandler.html" title="class in com.demandware.appsec.csrf"><span class="typeNameLink">Prev&nbsp;Class</span></a></li>
<li><a href="../../../../com/demandware/appsec/csrf/DefaultCSRFErrorHandler.html" title="class in com.demandware.appsec.csrf"><span class="typeNameLink">Next&nbsp;Class</span></a></li>
</ul>
<ul class="navList">
<li><a href="../../../../index.html?com/demandware/appsec/csrf/CSRFTokenManager.html" target="_top">Frames</a></li>
<li><a href="CSRFTokenManager.html" target="_top">No&nbsp;Frames</a></li>
</ul>
<ul class="navList" id="allclasses_navbar_top">
<li><a href="../../../../allclasses-noframe.html">All&nbsp;Classes</a></li>
</ul>
<div>
<script type="text/javascript"><!--
  allClassesLink = document.getElementById("allclasses_navbar_top");
  if(window==top) {
    allClassesLink.style.display = "block";
  }
  else {
    allClassesLink.style.display = "none";
  }
  //-->
</script>
</div>
<div>
<ul class="subNavList">
<li>Summary:&nbsp;</li>
<li>Nested&nbsp;|&nbsp;</li>
<li><a href="#field.summary">Field</a>&nbsp;|&nbsp;</li>
<li><a href="#constructor.summary">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method.summary">Method</a></li>
</ul>
<ul class="subNavList">
<li>Detail:&nbsp;</li>
<li><a href="#field.detail">Field</a>&nbsp;|&nbsp;</li>
<li><a href="#constructor.detail">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method.detail">Method</a></li>
</ul>
</div>
<a name="skip.navbar.top">
<!--   -->
</a></div>
<!-- ========= END OF TOP NAVBAR ========= -->
<!-- ======== START OF CLASS DATA ======== -->
<div class="header">
<div class="subTitle">com.demandware.appsec.csrf</div>
<h2 title="Class CSRFTokenManager" class="title">Class CSRFTokenManager</h2>
</div>
<div class="contentContainer">
<ul class="inheritance">
<li><a href="http://docs.oracle.com/javase/7/docs/api/java/lang/Object.html?is-external=true" title="class or interface in java.lang">java.lang.Object</a></li>
<li>
<ul class="inheritance">
<li>com.demandware.appsec.csrf.CSRFTokenManager</li>
</ul>
</li>
</ul>
<div class="description">
<ul class="blockList">
<li class="blockList">
<hr>
<br>
<pre>public class <span class="typeNameLabel">CSRFTokenManager</span>
extends <a href="http://docs.oracle.com/javase/7/docs/api/java/lang/Object.html?is-external=true" title="class or interface in java.lang">Object</a></pre>
<div class="block"><p>
 The CSRFTokenManager is in charge of generating and validating CSRF tokens. This CSRF defense allows applications to
 generate <a href="http://www.corej2eepatterns.com/Design/PresoDesign.htm"> synchronizer tokens</a> as recommended by
 <a href= "https://www.owasp.org/index.php/Cross-Site_Request_Forgery_(CSRF)_Prevention_Cheat_Sheet"> OWASP</a>. These
 tokens are semi-stateless (tied to session, but not stored anywhere) and so can be generated wherever in the
 application and validated wherever.
 </p>
 <p>
 In the default case, CSRF tokens are generated in this manner: <br>
 </p>
 <ol>
 <li>Given a SessionID (must be at least 16 bytes long), first generate a TokenID from a <a href="http://docs.oracle.com/javase/7/docs/api/java/security/SecureRandom.html?is-external=true" title="class or interface in java.security">SecureRandom</a>
 </li>
 <li>Next, get the current timestamp</li>
 <li>Create the text to be encrypted, cryptText, as SessionID|timestamp</li>
 <li>Use the TokenID as an IV and the first 16 bytes of the SessionID as key to encrypt the cryptText</li>
 <li>Then prepend the TokenID to the encrypted value. This is the Token</li>
 </ol>
 <p>
 In the default case, CSRF tokens are validated in this manner: <br>
 </p>
 <ol>
 <li>Given a SessionID and a Token, first split the token into TokenID and encrypted text</li>
 <li>Next, decrypt the encrypted text using the first 16 bytes of the SessionID as key and TokenID as IV</li>
 <li>Split the resulting cryptText into SessionID and timestamp</li>
 <li>validate that the full SessionID matches the decrypted version (not just first 16 bytes)</li>
 <li>validate that the timestamp is within the expiration time from now</li>
 </ol>
 <p>
 The generation and validation methods also allow application developers to specify further items to be encrypted (in
 addition to the sessionID and timestamp). These items are validated in their supplied order, so developers should
 take care to maintain the same order during validation as was used in generation.
 </p>
 <p>
 <b>Note:</b> By default, a <a href="../../../../com/demandware/appsec/csrf/CSRFErrorHandler.html" title="class in com.demandware.appsec.csrf">CSRFErrorHandler</a> is assigned to the Manager. This handler writes all data to
 SysErr during generation and validation when an error has occurred or validation has failed
 </p></div>
<dl>
<dt><span class="simpleTagLabel">Author:</span></dt>
<dd>Chris Smith</dd>
</dl>
</li>
</ul>
</div>
<div class="summary">
<ul class="blockList">
<li class="blockList">
<!-- =========== FIELD SUMMARY =========== -->
<ul class="blockList">
<li class="blockList"><a name="field.summary">
<!--   -->
</a>
<h3>Field Summary</h3>
<table class="memberSummary" border="0" cellpadding="3" cellspacing="0" summary="Field Summary table, listing fields, and an explanation">
<caption><span>Fields</span><span class="tabEnd">&nbsp;</span></caption>
<tr>
<th class="colFirst" scope="col">Modifier and Type</th>
<th class="colLast" scope="col">Field and Description</th>
</tr>
<tr class="altColor">
<td class="colFirst"><code>static <a href="http://docs.oracle.com/javase/7/docs/api/java/lang/String.html?is-external=true" title="class or interface in java.lang">String</a></code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../com/demandware/appsec/csrf/CSRFTokenManager.html#DEFAULT_CSRF_TOKEN_NAME">DEFAULT_CSRF_TOKEN_NAME</a></span></code>&nbsp;</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>static long</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../com/demandware/appsec/csrf/CSRFTokenManager.html#DEFAULT_EXPIRY">DEFAULT_EXPIRY</a></span></code>&nbsp;</td>
</tr>
</table>
</li>
</ul>
<!-- ======== CONSTRUCTOR SUMMARY ======== -->
<ul class="blockList">
<li class="blockList"><a name="constructor.summary">
<!--   -->
</a>
<h3>Constructor Summary</h3>
<table class="memberSummary" border="0" cellpadding="3" cellspacing="0" summary="Constructor Summary table, listing constructors, and an explanation">
<caption><span>Constructors</span><span class="tabEnd">&nbsp;</span></caption>
<tr>
<th class="colOne" scope="col">Constructor and Description</th>
</tr>
<tr class="altColor">
<td class="colOne"><code><span class="memberNameLink"><a href="../../../../com/demandware/appsec/csrf/CSRFTokenManager.html#CSRFTokenManager--">CSRFTokenManager</a></span>()</code>
<div class="block">Create a new <a href="../../../../com/demandware/appsec/csrf/CSRFTokenManager.html" title="class in com.demandware.appsec.csrf">CSRFTokenManager</a> with all defaults</div>
</td>
</tr>
<tr class="rowColor">
<td class="colOne"><code><span class="memberNameLink"><a href="../../../../com/demandware/appsec/csrf/CSRFTokenManager.html#CSRFTokenManager-java.security.SecureRandom-">CSRFTokenManager</a></span>(<a href="http://docs.oracle.com/javase/7/docs/api/java/security/SecureRandom.html?is-external=true" title="class or interface in java.security">SecureRandom</a>&nbsp;random)</code>
<div class="block">Create a new <a href="../../../../com/demandware/appsec/csrf/CSRFTokenManager.html" title="class in com.demandware.appsec.csrf">CSRFTokenManager</a> with all defaults and use the provided <a href="http://docs.oracle.com/javase/7/docs/api/java/security/SecureRandom.html?is-external=true" title="class or interface in java.security">SecureRandom</a></div>
</td>
</tr>
</table>
</li>
</ul>
<!-- ========== METHOD SUMMARY =========== -->
<ul class="blockList">
<li class="blockList"><a name="method.summary">
<!--   -->
</a>
<h3>Method Summary</h3>
<table class="memberSummary" border="0" cellpadding="3" cellspacing="0" summary="Method Summary table, listing methods, and an explanation">
<caption><span id="t0" class="activeTableTab"><span>All Methods</span><span class="tabEnd">&nbsp;</span></span><span id="t2" class="tableTab"><span><a href="javascript:show(2);">Instance Methods</a></span><span class="tabEnd">&nbsp;</span></span><span id="t4" class="tableTab"><span><a href="javascript:show(8);">Concrete Methods</a></span><span class="tabEnd">&nbsp;</span></span></caption>
<tr>
<th class="colFirst" scope="col">Modifier and Type</th>
<th class="colLast" scope="col">Method and Description</th>
</tr>
<tr id="i0" class="altColor">
<td class="colFirst"><code><a href="http://docs.oracle.com/javase/7/docs/api/java/lang/String.html?is-external=true" title="class or interface in java.lang">String</a></code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../com/demandware/appsec/csrf/CSRFTokenManager.html#generateToken-java.lang.String-java.lang.String...-">generateToken</a></span>(<a href="http://docs.oracle.com/javase/7/docs/api/java/lang/String.html?is-external=true" title="class or interface in java.lang">String</a>&nbsp;sessionID,
             <a href="http://docs.oracle.com/javase/7/docs/api/java/lang/String.html?is-external=true" title="class or interface in java.lang">String</a>...&nbsp;otherData)</code>
<div class="block">Builds a secure token used to protect against CSRF attacks.</div>
</td>
</tr>
<tr id="i1" class="rowColor">
<td class="colFirst"><code>long</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../com/demandware/appsec/csrf/CSRFTokenManager.html#getAllowedExpiry--">getAllowedExpiry</a></span>()</code>
<div class="block">Returns the expiration time in milliseconds for CSRF Tokens</div>
</td>
</tr>
<tr id="i2" class="altColor">
<td class="colFirst"><code><a href="http://docs.oracle.com/javase/7/docs/api/java/lang/String.html?is-external=true" title="class or interface in java.lang">String</a></code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../com/demandware/appsec/csrf/CSRFTokenManager.html#getCSRFTokenName--">getCSRFTokenName</a></span>()</code>
<div class="block">Returns the assigned name for CSRF tokens</div>
</td>
</tr>
<tr id="i3" class="rowColor">
<td class="colFirst"><code>protected long</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../com/demandware/appsec/csrf/CSRFTokenManager.html#getCurrentTime--">getCurrentTime</a></span>()</code>
<div class="block">Return the current time for this application, in milliseconds.</div>
</td>
</tr>
<tr id="i4" class="altColor">
<td class="colFirst"><code>void</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../com/demandware/appsec/csrf/CSRFTokenManager.html#setAllowedExpiry-long-">setAllowedExpiry</a></span>(long&nbsp;expiry)</code>
<div class="block">Configure a new expiration time on tokens.</div>
</td>
</tr>
<tr id="i5" class="rowColor">
<td class="colFirst"><code>void</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../com/demandware/appsec/csrf/CSRFTokenManager.html#setCSRFTokenName-java.lang.String-">setCSRFTokenName</a></span>(<a href="http://docs.oracle.com/javase/7/docs/api/java/lang/String.html?is-external=true" title="class or interface in java.lang">String</a>&nbsp;tokenName)</code>
<div class="block">Configure a new token name.</div>
</td>
</tr>
<tr id="i6" class="altColor">
<td class="colFirst"><code>void</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../com/demandware/appsec/csrf/CSRFTokenManager.html#setErrorHandler-com.demandware.appsec.csrf.CSRFErrorHandler-">setErrorHandler</a></span>(<a href="../../../../com/demandware/appsec/csrf/CSRFErrorHandler.html" title="class in com.demandware.appsec.csrf">CSRFErrorHandler</a>&nbsp;handler)</code>
<div class="block">Configure this object to use a different <a href="../../../../com/demandware/appsec/csrf/CSRFErrorHandler.html" title="class in com.demandware.appsec.csrf">CSRFErrorHandler</a></div>
</td>
</tr>
<tr id="i7" class="rowColor">
<td class="colFirst"><code>boolean</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../com/demandware/appsec/csrf/CSRFTokenManager.html#validateToken-java.lang.String-java.lang.String-java.lang.String...-">validateToken</a></span>(<a href="http://docs.oracle.com/javase/7/docs/api/java/lang/String.html?is-external=true" title="class or interface in java.lang">String</a>&nbsp;token,
             <a href="http://docs.oracle.com/javase/7/docs/api/java/lang/String.html?is-external=true" title="class or interface in java.lang">String</a>&nbsp;sessionID,
             <a href="http://docs.oracle.com/javase/7/docs/api/java/lang/String.html?is-external=true" title="class or interface in java.lang">String</a>...&nbsp;otherData)</code>
<div class="block">Ensures that the supplied token is a valid csrf token.</div>
</td>
</tr>
</table>
<ul class="blockList">
<li class="blockList"><a name="methods.inherited.from.class.java.lang.Object">
<!--   -->
</a>
<h3>Methods inherited from class&nbsp;java.lang.<a href="http://docs.oracle.com/javase/7/docs/api/java/lang/Object.html?is-external=true" title="class or interface in java.lang">Object</a></h3>
<code><a href="http://docs.oracle.com/javase/7/docs/api/java/lang/Object.html?is-external=true#clone--" title="class or interface in java.lang">clone</a>, <a href="http://docs.oracle.com/javase/7/docs/api/java/lang/Object.html?is-external=true#equals-java.lang.Object-" title="class or interface in java.lang">equals</a>, <a href="http://docs.oracle.com/javase/7/docs/api/java/lang/Object.html?is-external=true#finalize--" title="class or interface in java.lang">finalize</a>, <a href="http://docs.oracle.com/javase/7/docs/api/java/lang/Object.html?is-external=true#getClass--" title="class or interface in java.lang">getClass</a>, <a href="http://docs.oracle.com/javase/7/docs/api/java/lang/Object.html?is-external=true#hashCode--" title="class or interface in java.lang">hashCode</a>, <a href="http://docs.oracle.com/javase/7/docs/api/java/lang/Object.html?is-external=true#notify--" title="class or interface in java.lang">notify</a>, <a href="http://docs.oracle.com/javase/7/docs/api/java/lang/Object.html?is-external=true#notifyAll--" title="class or interface in java.lang">notifyAll</a>, <a href="http://docs.oracle.com/javase/7/docs/api/java/lang/Object.html?is-external=true#toString--" title="class or interface in java.lang">toString</a>, <a href="http://docs.oracle.com/javase/7/docs/api/java/lang/Object.html?is-external=true#wait--" title="class or interface in java.lang">wait</a>, <a href="http://docs.oracle.com/javase/7/docs/api/java/lang/Object.html?is-external=true#wait-long-" title="class or interface in java.lang">wait</a>, <a href="http://docs.oracle.com/javase/7/docs/api/java/lang/Object.html?is-external=true#wait-long-int-" title="class or interface in java.lang">wait</a></code></li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
<div class="details">
<ul class="blockList">
<li class="blockList">
<!-- ============ FIELD DETAIL =========== -->
<ul class="blockList">
<li class="blockList"><a name="field.detail">
<!--   -->
</a>
<h3>Field Detail</h3>
<a name="DEFAULT_EXPIRY">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>DEFAULT_EXPIRY</h4>
<pre>public static final&nbsp;long DEFAULT_EXPIRY</pre>
<dl>
<dt><span class="seeLabel">See Also:</span></dt>
<dd><a href="../../../../constant-values.html#com.demandware.appsec.csrf.CSRFTokenManager.DEFAULT_EXPIRY">Constant Field Values</a></dd>
</dl>
</li>
</ul>
<a name="DEFAULT_CSRF_TOKEN_NAME">
<!--   -->
</a>
<ul class="blockListLast">
<li class="blockList">
<h4>DEFAULT_CSRF_TOKEN_NAME</h4>
<pre>public static final&nbsp;<a href="http://docs.oracle.com/javase/7/docs/api/java/lang/String.html?is-external=true" title="class or interface in java.lang">String</a> DEFAULT_CSRF_TOKEN_NAME</pre>
<dl>
<dt><span class="seeLabel">See Also:</span></dt>
<dd><a href="../../../../constant-values.html#com.demandware.appsec.csrf.CSRFTokenManager.DEFAULT_CSRF_TOKEN_NAME">Constant Field Values</a></dd>
</dl>
</li>
</ul>
</li>
</ul>
<!-- ========= CONSTRUCTOR DETAIL ======== -->
<ul class="blockList">
<li class="blockList"><a name="constructor.detail">
<!--   -->
</a>
<h3>Constructor Detail</h3>
<a name="CSRFTokenManager--">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>CSRFTokenManager</h4>
<pre>public&nbsp;CSRFTokenManager()</pre>
<div class="block">Create a new <a href="../../../../com/demandware/appsec/csrf/CSRFTokenManager.html" title="class in com.demandware.appsec.csrf">CSRFTokenManager</a> with all defaults</div>
</li>
</ul>
<a name="CSRFTokenManager-java.security.SecureRandom-">
<!--   -->
</a>
<ul class="blockListLast">
<li class="blockList">
<h4>CSRFTokenManager</h4>
<pre>public&nbsp;CSRFTokenManager(<a href="http://docs.oracle.com/javase/7/docs/api/java/security/SecureRandom.html?is-external=true" title="class or interface in java.security">SecureRandom</a>&nbsp;random)</pre>
<div class="block">Create a new <a href="../../../../com/demandware/appsec/csrf/CSRFTokenManager.html" title="class in com.demandware.appsec.csrf">CSRFTokenManager</a> with all defaults and use the provided <a href="http://docs.oracle.com/javase/7/docs/api/java/security/SecureRandom.html?is-external=true" title="class or interface in java.security">SecureRandom</a></div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>random</code> - a <a href="http://docs.oracle.com/javase/7/docs/api/java/security/SecureRandom.html?is-external=true" title="class or interface in java.security">SecureRandom</a> instance to use in generating random tokens</dd>
</dl>
</li>
</ul>
</li>
</ul>
<!-- ============ METHOD DETAIL ========== -->
<ul class="blockList">
<li class="blockList"><a name="method.detail">
<!--   -->
</a>
<h3>Method Detail</h3>
<a name="setErrorHandler-com.demandware.appsec.csrf.CSRFErrorHandler-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>setErrorHandler</h4>
<pre>public&nbsp;void&nbsp;setErrorHandler(<a href="../../../../com/demandware/appsec/csrf/CSRFErrorHandler.html" title="class in com.demandware.appsec.csrf">CSRFErrorHandler</a>&nbsp;handler)
                     throws <a href="http://docs.oracle.com/javase/7/docs/api/java/lang/IllegalArgumentException.html?is-external=true" title="class or interface in java.lang">IllegalArgumentException</a></pre>
<div class="block">Configure this object to use a different <a href="../../../../com/demandware/appsec/csrf/CSRFErrorHandler.html" title="class in com.demandware.appsec.csrf">CSRFErrorHandler</a></div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>handler</code> - the <a href="../../../../com/demandware/appsec/csrf/CSRFErrorHandler.html" title="class in com.demandware.appsec.csrf">CSRFErrorHandler</a> to use</dd>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code><a href="http://docs.oracle.com/javase/7/docs/api/java/lang/IllegalArgumentException.html?is-external=true" title="class or interface in java.lang">IllegalArgumentException</a></code> - if the handler is null</dd>
</dl>
</li>
</ul>
<a name="getCSRFTokenName--">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getCSRFTokenName</h4>
<pre>public&nbsp;<a href="http://docs.oracle.com/javase/7/docs/api/java/lang/String.html?is-external=true" title="class or interface in java.lang">String</a>&nbsp;getCSRFTokenName()</pre>
<div class="block">Returns the assigned name for CSRF tokens</div>
<dl>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>CSRF Token parameter name</dd>
</dl>
</li>
</ul>
<a name="setCSRFTokenName-java.lang.String-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>setCSRFTokenName</h4>
<pre>public&nbsp;void&nbsp;setCSRFTokenName(<a href="http://docs.oracle.com/javase/7/docs/api/java/lang/String.html?is-external=true" title="class or interface in java.lang">String</a>&nbsp;tokenName)
                      throws <a href="http://docs.oracle.com/javase/7/docs/api/java/lang/IllegalArgumentException.html?is-external=true" title="class or interface in java.lang">IllegalArgumentException</a></pre>
<div class="block">Configure a new token name. This is a convenience method</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>tokenName</code> - the new name for the token</dd>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code><a href="http://docs.oracle.com/javase/7/docs/api/java/lang/IllegalArgumentException.html?is-external=true" title="class or interface in java.lang">IllegalArgumentException</a></code> - if the tokenName is null</dd>
</dl>
</li>
</ul>
<a name="getAllowedExpiry--">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getAllowedExpiry</h4>
<pre>public&nbsp;long&nbsp;getAllowedExpiry()</pre>
<div class="block">Returns the expiration time in milliseconds for CSRF Tokens</div>
<dl>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>CSRF Token parameter expiration in millis</dd>
</dl>
</li>
</ul>
<a name="setAllowedExpiry-long-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>setAllowedExpiry</h4>
<pre>public&nbsp;void&nbsp;setAllowedExpiry(long&nbsp;expiry)
                      throws <a href="http://docs.oracle.com/javase/7/docs/api/java/lang/IllegalArgumentException.html?is-external=true" title="class or interface in java.lang">IllegalArgumentException</a></pre>
<div class="block">Configure a new expiration time on tokens. This takes effect immediately on all outstanding tokens. e.g. if the
 old expiry were 10 mins and the new expiry is 20 mins, all tokens generated 19 mins ago are now valid, even
 though they weren't before the expiration was reset.</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>expiry</code> - the new expiration time in milliseconds</dd>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code><a href="http://docs.oracle.com/javase/7/docs/api/java/lang/IllegalArgumentException.html?is-external=true" title="class or interface in java.lang">IllegalArgumentException</a></code> - if the expiration time is less that 0</dd>
</dl>
</li>
</ul>
<a name="generateToken-java.lang.String-java.lang.String...-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>generateToken</h4>
<pre>public&nbsp;<a href="http://docs.oracle.com/javase/7/docs/api/java/lang/String.html?is-external=true" title="class or interface in java.lang">String</a>&nbsp;generateToken(<a href="http://docs.oracle.com/javase/7/docs/api/java/lang/String.html?is-external=true" title="class or interface in java.lang">String</a>&nbsp;sessionID,
                            <a href="http://docs.oracle.com/javase/7/docs/api/java/lang/String.html?is-external=true" title="class or interface in java.lang">String</a>...&nbsp;otherData)
                     throws <a href="http://docs.oracle.com/javase/7/docs/api/java/lang/IllegalArgumentException.html?is-external=true" title="class or interface in java.lang">IllegalArgumentException</a></pre>
<div class="block">Builds a secure token used to protect against CSRF attacks. Additional data may be used to further lengthen the
 resulting token</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>sessionID</code> - the sessionID of this request</dd>
<dd><code>otherData</code> - (Optional) any other strings that should be used to generate the token. See class definition.</dd>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>a new CSRF token value for this session</dd>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code><a href="http://docs.oracle.com/javase/7/docs/api/java/lang/IllegalArgumentException.html?is-external=true" title="class or interface in java.lang">IllegalArgumentException</a></code> - if the sessionID is null</dd>
</dl>
</li>
</ul>
<a name="validateToken-java.lang.String-java.lang.String-java.lang.String...-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>validateToken</h4>
<pre>public&nbsp;boolean&nbsp;validateToken(<a href="http://docs.oracle.com/javase/7/docs/api/java/lang/String.html?is-external=true" title="class or interface in java.lang">String</a>&nbsp;token,
                             <a href="http://docs.oracle.com/javase/7/docs/api/java/lang/String.html?is-external=true" title="class or interface in java.lang">String</a>&nbsp;sessionID,
                             <a href="http://docs.oracle.com/javase/7/docs/api/java/lang/String.html?is-external=true" title="class or interface in java.lang">String</a>...&nbsp;otherData)
                      throws <a href="http://docs.oracle.com/javase/7/docs/api/java/lang/IllegalArgumentException.html?is-external=true" title="class or interface in java.lang">IllegalArgumentException</a></pre>
<div class="block">Ensures that the supplied token is a valid csrf token. Valid tokens are made up of the current session, randomly
 generated token, timestamp, and any other data supplied. The timestamp must be within some number of milliseconds
 before now based on the <a href="../../../../com/demandware/appsec/csrf/CSRFTokenManager.html#getAllowedExpiry--">getAllowedExpiry()</a></div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>token</code> - the incoming token to test against</dd>
<dd><code>sessionID</code> - the sessionID of the current request</dd>
<dd><code>otherData</code> - (Optional) any other strings that should be used to validate the token. See class definition.</dd>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>true if the token is valid for this sessionID. false otherwise</dd>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code><a href="http://docs.oracle.com/javase/7/docs/api/java/lang/IllegalArgumentException.html?is-external=true" title="class or interface in java.lang">IllegalArgumentException</a></code> - if the session ID is null</dd>
</dl>
</li>
</ul>
<a name="getCurrentTime--">
<!--   -->
</a>
<ul class="blockListLast">
<li class="blockList">
<h4>getCurrentTime</h4>
<pre>protected&nbsp;long&nbsp;getCurrentTime()</pre>
<div class="block">Return the current time for this application, in milliseconds. This method is exposed to subclasses as system
 clocks may vary in multinode cloud environments that may span normal datetimes.</div>
<dl>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>the current time in milliseconds</dd>
</dl>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
</div>
<!-- ========= END OF CLASS DATA ========= -->
<!-- ======= START OF BOTTOM NAVBAR ====== -->
<div class="bottomNav"><a name="navbar.bottom">
<!--   -->
</a>
<div class="skipNav"><a href="#skip.navbar.bottom" title="Skip navigation links">Skip navigation links</a></div>
<a name="navbar.bottom.firstrow">
<!--   -->
</a>
<ul class="navList" title="Navigation">
<li><a href="../../../../com/demandware/appsec/csrf/package-summary.html">Package</a></li>
<li class="navBarCell1Rev">Class</li>
<li><a href="class-use/CSRFTokenManager.html">Use</a></li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../../../index-all.html">Index</a></li>
<li><a href="../../../../help-doc.html">Help</a></li>
</ul>
</div>
<div class="subNav">
<ul class="navList">
<li><a href="../../../../com/demandware/appsec/csrf/CSRFErrorHandler.html" title="class in com.demandware.appsec.csrf"><span class="typeNameLink">Prev&nbsp;Class</span></a></li>
<li><a href="../../../../com/demandware/appsec/csrf/DefaultCSRFErrorHandler.html" title="class in com.demandware.appsec.csrf"><span class="typeNameLink">Next&nbsp;Class</span></a></li>
</ul>
<ul class="navList">
<li><a href="../../../../index.html?com/demandware/appsec/csrf/CSRFTokenManager.html" target="_top">Frames</a></li>
<li><a href="CSRFTokenManager.html" target="_top">No&nbsp;Frames</a></li>
</ul>
<ul class="navList" id="allclasses_navbar_bottom">
<li><a href="../../../../allclasses-noframe.html">All&nbsp;Classes</a></li>
</ul>
<div>
<script type="text/javascript"><!--
  allClassesLink = document.getElementById("allclasses_navbar_bottom");
  if(window==top) {
    allClassesLink.style.display = "block";
  }
  else {
    allClassesLink.style.display = "none";
  }
  //-->
</script>
</div>
<div>
<ul class="subNavList">
<li>Summary:&nbsp;</li>
<li>Nested&nbsp;|&nbsp;</li>
<li><a href="#field.summary">Field</a>&nbsp;|&nbsp;</li>
<li><a href="#constructor.summary">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method.summary">Method</a></li>
</ul>
<ul class="subNavList">
<li>Detail:&nbsp;</li>
<li><a href="#field.detail">Field</a>&nbsp;|&nbsp;</li>
<li><a href="#constructor.detail">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method.detail">Method</a></li>
</ul>
</div>
<a name="skip.navbar.bottom">
<!--   -->
</a></div>
<!-- ======== END OF BOTTOM NAVBAR ======= -->
<p class="legalCopy"><small>Copyright &#169; 2016. All rights reserved.</small></p>
</body>
</html>
